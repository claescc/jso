<!DOCTYPE html>
<html lang="nl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>JQuery Ajax client</title>
    <script src="http://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script>
<<<<<<< HEAD
        $(function () { // onload
            $('#btnget').click(function () {
                $.ajax('http://localhost:8080/namen', {
=======
        $(function(){
            $('#btnget').click(function(){
               toonLijst();
            })
            $('#btngetid').click(function(){
                let idwaarde = parseInt($('#inputid').val());
                $.ajax('http://localhost:8080/namen',{
>>>>>>> 368b06db75113eb06dc8cf41506ae7bf62c255f3
                    method: 'GET',
                    dataType: 'json',
                    data: { id: idwaarde}
                }).done(function(data){
                    $('#zangeresid').text(data.id);
                    $('#zangeresvoornaam').text(data.voornaam);
                    $('#zangeresachternaam').text(data.achternaam);
                    $('#zangereserror').text('');
                }).fail(function(obj, err, msg){
                    $('#zangereserror').text(msg);
                });
            });
            $('#btndelete').click(function(){
               deleteZangeres(3);
            });
            $('#btnpost').click(function(){
               createZangeres(4, 'Josje', 'Huisman');
            });
            $('#btnToevoegen').click(function(){
                console.log("op toevoegen geklikt");
                let id = $('#inputId').val();
                let voornaam = $('#inputVoornaam').val();
                let achternaam = $('#inputAchternaam').val();
                createZangeres(id, voornaam, achternaam);
                $('#inputId').val('');
                $('#inputVoornaam').val('');
                $('#inputAchternaam').val('');
            })
        })
        function deleteZangeres(id){
            $.ajax('http://localhost:8080/namen?id='+id,{
                    method:'DELETE',
                    dataType: 'json'
                }).done(function(data){
                    console.log(data);                   
                }).fail(function(obj, err, msg){
                    console.log(msg);
                }).always(function(){
                    toonLijst();
                });
        }
        function createZangeres(id, voornaam, achternaam){
            $.ajax('http://localhost:8080/namen',{
                    method: 'POST',
                    data: JSON.stringify({id: id, voornaam: voornaam, achternaam: achternaam})
                }).done(function(data){
                    console.dir(data);
                }).fail(function(obj, err, msg){
                    console.log(msg);
                }).always(() => toonLijst());
        }
        function toonLijst(){
            console.log('Ik toon de lijst');
            $.ajax('http://localhost:8080/namen',{
                    method: 'GET',
                    dataType: 'json'
<<<<<<< HEAD
                    // DONE AND FAIL INBOUWEN
                }).done(function (data) { // alles binnengehaald = DONE 
                    let $tbody = $('#tabel'); //TIP: NEW VAR + $ FOR JQUERY VARIABLES    
                    // $tbody.html(''); // CLEAR VORIGE TABEL
                    $tbody.empty()
                    for (let i = 0; i < data.length; i++) { //  CREATE: $('<tr>')  FIND: $('tr')
                        // CREATE TAGS
                        let $newRow = $('<tr>');
                        let $newid = $('<td>');
                        let $newN = $('<td>');
                        let $newA = $('<td>');
                        let $actie = $('<td>')
                            let button = $('<button>delete</button>').click(function (){
                               let cijfer =  $(this).parent().parent().first().text();
                               $(this).parent().parent().remove();
                               serverDelete(cijfer);
                            })
                        $actie.append(button);
                        //    let $newA = $('<td>').text(data[i].achternaam);
                        // TEXT TOEVOEGEN --> FUNCTIE TEXT()
                        $newid.text(data[i].id);  // ArrayData met objecten {id:1  vn:  an: }
                        $newN.text(data[i].voornaam);
                        $newA.text(data[i].achternaam);
                        // APPEND 
                        $newRow.append($newid).append($newN).append($newA).append($actie);
                        $tbody.append($newRow)
=======
                }).done(function(data){
                    let $tbody = $('tbody', '#tabel');
                    //$tbody.html('');
                    $tbody.empty();
                    for(let i=0; i<data.length; i++){
                        console.log(data[i]);
                        let $rij = $('<tr>');
                        let $tdId = $('<td>').append(data[i].id);
                        let $tdVoornaam = $('<td>').text(data[i].voornaam);
                        let $tdAchternaam = $('<td>').text(data[i].achternaam);
                        let $button = $('<button>').text('Verwijderen').attr('data-id', data[i].id);
                        $button.click(function(){
                            console.dir($(this).data('id'));
                            deleteZangeres(data[i].id);
                            
                        })
                        let $tdbutton = $('<td>').append($button);
                        $rij.append($tdId).append($tdVoornaam).append($tdAchternaam).append($tdbutton);
                        //
                        //alternatief
                        //
                        //$rij.html('<td>'+data[i].id + '</td><td>'+data[i].voornaam+'</td><td>'+ data[i].achternaam+'</td>');
                        $tbody.append($rij);
>>>>>>> 368b06db75113eb06dc8cf41506ae7bf62c255f3
                    }
                    //    console.dir(data); // .dir ipv .log
                    //    console.table(data); // .table -> in terminal tabel te zien
                }).fail(function (msg) { // FOUTMELDING
                    console.dir(msg);
                })
<<<<<<< HEAD
            });
            // Onload
            $('#btnid').click(function () {
                // let input = document.getElementById('nr');
                // var nummer = input.value;
                let nummer = parseInt($('#nr').val());
                if (nummer >= 1 && nummer <= 3) {
                    $.ajax('http://localhost:8080/namen', {
                        method: 'GET',
                        dataType: 'json',
                        data: { id: nummer }
                    }).done(function (data) {
                        let $tbody = $('#tabel');
                        $tbody.empty();
                        let $newRow = $('<tr>');
                        let $newid = $('<td>').text(data.id);
                        let $newN = $('<td>').text(data.voornaam);
                        let $newA = $('<td>').text(data.achternaam);
                        // APPEND 
                        $newRow.append($newid).append($newN).append($newA);
                        $tbody.append($newRow)
                    }).fail(function (obj, err, msg) {
                        console.dir(msg);
                    });
                } else {
                    console.dir('Error wrong nr');
                }
            });
            // Onload
            $('#btndelete').click(function () {
                $.ajax('http://localhost:8080/namen?id=3', { // QUERY STRING
                    method: 'DELETE',  // moet cijfer mee in de Querystring staan
                    dataType: 'json',
                }).done(function (data) {
                    console.log(data);
                }).fail(function (obj, err, msg) {
                    console.dir(msg);
                });
            });
        });
        function serverDelete(cijfer){
            let string = 'http://localhost:8080/namen?id=' + cijfer;
            $.ajax(string, { // QUERY STRING
                    method: 'DELETE',  // moet cijfer mee in de Querystring staan
                    dataType: 'json',
                });
        
=======
>>>>>>> 368b06db75113eb06dc8cf41506ae7bf62c255f3
        }
    </script>
</head>

<body>
<<<<<<< HEAD
    <button id='btnget'>Get data via Ajax</button>
    <button id='btndelete'>delete</button>
    <br><br>
    <button id='btnid'>Get data via ID </button>
    <input type='number' id='nr'>
    <table>
=======
    <button id='btnget'>Get data</button>
    <button id='btndelete'>Delete zangeres</button>
    <form>
        <button type="button" id='btngetid'>Get data via id</button>
        <input type="number" min="0" id="inputid"/>
    </form>
    <button id='btnpost'>Create zangeres</button>
    <div id="zangeres">
        <span>Id:</span><span id="zangeresid"></span>
        <span>Voornaam:</span><span id="zangeresvoornaam"></span>
        <span>Achternaam: </span><span id="zangeresachternaam"></span>
        <span id="zangereserror"></span>
    </div>
    <table id='tabel'>
>>>>>>> 368b06db75113eb06dc8cf41506ae7bf62c255f3
        <thead>
            <tr>
                <th>Id</th>
                <th>Voornaam</th>
                <th>Achternaam</th>
                <th>Actie</th>
            </tr>
        </thead>
<<<<<<< HEAD
        <tbody id='tabel'>

=======
        <tbody>
            
>>>>>>> 368b06db75113eb06dc8cf41506ae7bf62c255f3
        </tbody>
        <tfoot>
                <tr>
                        <td><input type="number" id="inputId"/></td>
                        <td><input type="text" id="inputVoornaam"></td>
                        <td><input type="text" id="inputAchternaam"></td>
                        <td><button type="button" id="btnToevoegen">Toevoegen</button></td>
                </tr>
        </tfoot>
    </table>

</body>

</html>